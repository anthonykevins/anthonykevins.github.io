(function(e){let u=e(".navbar"),t=u.innerHeight();function i(n){n=typeof n=="undefined"||typeof n=="object"?window.location.hash:n,n=n.replace(/:/g,"\\:"),e(n).length&&(e("body").addClass("scrolling"),e("html, body").animate({scrollTop:e(n).offset().top-t},600,function(){e("body").removeClass("scrolling")}))}function p(){let n=e("body"),s=n.data("bs.scrollspy");s&&(s._config.offset=t,n.data("bs.scrollspy",s),n.scrollspy("refresh"))}window.addEventListener("hashchange",i),e("#navbar-main li.nav-item a.nav-link").on("click",function(n){let s=this.hash;s&&e(s).length&&e("#homepage").length>0&&(n.preventDefault(),e("html, body").animate({scrollTop:e(s).offset().top-t},800))}),e("#back_to_top").on("click",function(t){t.preventDefault(),e("html, body").animate({scrollTop:0},800,function(){window.location.hash=""})}),e(document).on("click",".navbar-collapse.show",function(t){let n=e(t.target).is("a")?e(t.target):e(t.target).parent();n.is("a")&&n.attr("class")!="dropdown-toggle"&&e(this).collapse("hide")});let n={},r,s,o=e("#container-publications");o.isotope({itemSelector:".isotope-item",percentPosition:!0,masonry:{columnWidth:".grid-sizer"},filter:function(){let t=e(this),n=!r||t.text().match(r),o=!s||t.is(s);return n&&o}});let l=e(".filter-search").keyup(d(function(){r=new RegExp(l.val(),"gi"),o.isotope()}));function d(e,t){let n;return t=t||100,function(){clearTimeout(n);let o=arguments,i=this;function a(){e.apply(i,o)}n=setTimeout(a,t)}}function c(e){let t="";for(let n in e)t+=e[n];return t}e(".pub-filters").on("change",function(){let i=e(this),t=i[0].getAttribute("data-filter-group");if(n[t]=this.value,s=c(n),o.isotope(),t=="pubtype"){let t=e(this).val();t.substr(0,9)==".pubtype-"?window.location.hash=t.substr(9):window.location.hash=""}});function h(){let t=window.location.hash.replace("#",""),i="*";t!=""&&!isNaN(t)&&(i=".pubtype-"+t);let a="pubtype";n[a]=i,s=c(n),o.isotope(),e(".pubtype-select").val(i)}function m(){if(e("#map").length){let i=e("#map-provider").val(),t=e("#map-lat").val(),n=e("#map-lng").val(),s=parseInt(e("#map-zoom").val()),o=e("#map-dir").val(),a=e("#map-api-key").val();if(i==1){let e=new GMaps({div:"#map",lat:t,lng:n,zoom:s,zoomControl:!0,zoomControlOpt:{style:"SMALL",position:"TOP_LEFT"},panControl:!1,streetViewControl:!1,mapTypeControl:!1,overviewMapControl:!1,scrollwheel:!0,draggable:!0});e.addMarker({lat:t,lng:n,click:function(){let s="https://www.google.com/maps/place/"+encodeURIComponent(o)+"/@"+t+","+n+"/";window.open(s,"_blank")},title:o})}else{let e=new L.map("map").setView([t,n],s);i==3&&a.length?L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}",{attribution:'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">Mapbox</a>',maxZoom:18,id:"mapbox.streets",accessToken:a}).addTo(e):L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(e);let r=L.marker([t,n]).addTo(e),c=t+","+n+"#map="+s+"/"+t+"/"+n+"&layers=N";r.bindPopup(o+'<p><a href="https://www.openstreetmap.org/directions?engine=osrm_car&route='+c+'">Routing via OpenStreetMap</a></p>')}}}function f(t,n){e.getJSON("https://api.github.com/repos/"+n+"/tags").done(function(n){let s=n[0];e(t).append(s.name)}).fail(function(e,t,n){let s=t+", "+n;console.log("Request Failed: "+s)})}function a(){e("body").hasClass("searching")?(e("[id=search-query]").blur(),e("body").removeClass("searching")):(e("body").addClass("searching"),e(".search-results").css({opacity:0,visibility:"visible"}).animate({opacity:1},200),e("#search-query").focus())}function g(){e("body").hasClass("dark")?(e("body").css({opacity:0,visibility:"visible"}).animate({opacity:1},500),e("body").removeClass("dark"),e("link[title=hl-light]")[0].disabled=!1,e("link[title=hl-dark]")[0].disabled=!0,e(".js-dark-toggle i").removeClass("fa-sun"),e(".js-dark-toggle i").addClass("fa-moon"),localStorage.setItem("dark_mode","0")):(e("body").css({opacity:0,visibility:"visible"}).animate({opacity:1},500),e("body").addClass("dark"),e("link[title=hl-light]")[0].disabled=!0,e("link[title=hl-dark]")[0].disabled=!1,e(".js-dark-toggle i").removeClass("fa-moon"),e(".js-dark-toggle i").addClass("fa-sun"),localStorage.setItem("dark_mode","1"))}e(document).ready(function(){let t=0;e("body").hasClass("dark")&&(t=1);let n=parseInt(localStorage.getItem("dark_mode")||t);n?(e("body").addClass("dark"),e("link[title=hl-light]")[0].disabled=!0,e("link[title=hl-dark]")[0].disabled=!1,e(".js-dark-toggle i").removeClass("fa-moon"),e(".js-dark-toggle i").addClass("fa-sun")):(e("body").removeClass("dark"),e("link[title=hl-light]")[0].disabled=!1,e("link[title=hl-dark]")[0].disabled=!0,e(".js-dark-toggle i").removeClass("fa-sun"),e(".js-dark-toggle i").addClass("fa-moon"))}),e(window).on("load",function(){window.location.hash&&(window.location.hash=="#top"?window.location.hash="":e(".projects-container").length||i());let s=e("body");s.scrollspy({offset:t});let n;e(window).resize(function(){clearTimeout(n),n=setTimeout(p,200)}),e(".projects-container").each(function(t,n){let s=e(n),o=s.closest("section"),a;o.find(".isotope").hasClass("js-layout-row")?a="fitRows":a="masonry",s.imagesLoaded(function(){s.isotope({itemSelector:".isotope-item",layoutMode:a,masonry:{gutter:20},filter:o.find(".default-project-filter").text()}),o.find(".project-filters a").click(function(){let t=e(this).attr("data-filter");return s.isotope({filter:t}),e(this).removeClass("active").addClass("active").siblings().removeClass("active all"),!1}),window.location.hash&&i()})}),e(".pub-filters-select")&&h(),e(".js-cite-modal").click(function(t){t.preventDefault();let n=e(this).attr("data-filename"),s=e("#modal");s.find(".modal-body code").load(n,function(t,s,o){if(s=="error"){let t="Error: ";e("#modal-error").html(t+o.status+" "+o.statusText)}else e(".js-download-cite").attr("href",n)}),s.modal("show")}),e(".js-copy-cite").click(function(e){e.preventDefault();let t=document.createRange(),n=document.querySelector("#modal .modal-body");t.selectNode(n),window.getSelection().addRange(t);try{document.execCommand("copy")}catch{console.log("Error: citation copy failed.")}window.getSelection().removeRange(t)}),m(),e("#TableOfContents > ul > li > ul").unwrap().unwrap(),e("#academic-release").length>0&&f("#academic-release",e("#academic-release").data("repo")),e(".js-search").click(function(e){e.preventDefault(),a()}),e(document).on("keydown",function(t){t.which==27?e("body").hasClass("searching")&&a():t.which==191&&t.shiftKey==!1&&!e("input,textarea").is(":focus")&&(t.preventDefault(),a())}),e(".js-dark-toggle").click(function(e){e.preventDefault(),g()})})})(jQuery)